tests:
  # request checks
  - name: Req
    file: &req-file publish-enqueue.req.vm
    context:
      stash:
        queue_table: q_table
        queue_version: v1
        user: abc#123
        event_bus: some-event-bus
        mutation: join-queue
    expect:
      version: '2018-05-29'
      method: POST
      resourcePath: "/"
      params:
        headers:
          content-type: application/x-amz-json-1.1
          x-amz-target: AWSEvents.PutEvents
        body:
          Entries:
          - Source: Slippi
            EventBusName: some-event-bus
            Detail: '{"event":"enqueue","queue":"q_table","version":"v1","user":"abc#123"}'
            DetailType: join-queue

  # response checks
  - name: Resp - Success
    file: &resp-file publish-enqueue.resp.vm
    context:
      result:
        statusCode: 200
    expect:
      statusCode: 200

  - name: Resp - Bad Response
    file: *resp-file
    context:
      result:
        statusCode: 500
        body: Internal Server Error
    expect: null

  - name: Resp - Error
    file: *resp-file
    context:
      error:
        message: error
        type: error
    expect: null